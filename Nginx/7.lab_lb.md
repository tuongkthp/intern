# Test load balancing
Tạo file cấu hình cho server test1 /etc/nginx/conf.d/test1.conf
```sh
server{
        listen 9998;
        server_name www.test1.com test1.com;
        location / {
                root /var/www/html;
                index test1.html;
        }
}
```
Tạo file cấu hình cho server test2 /etc/nginx/conf.d/test2.conf
```sh
server{
        listen 9999;
        server_name www.test2.com test2.com;
        location / {
                root /var/www/html;
                index test2.html;
        }
}
```

Tạo 2 file html
```sh
cat <<EOF >> /var/www/html/test1.html
<h1>This is test1</h1>
EOF

cat <<EOF >>/var/www/html/test2.html
<h1>This is test2</h1>
EOF
```

Tạo file cấu hình lb /etc/nginx/conf.d/testlb.conf
```sh
upstream backend {
        server 192.168.64.53:9998 weight=3;
        server 192.168.64.53:9999 weight=2;
}


server {
        listen 192.168.64.53:8000;

        location /testlb {
                proxy_pass http://backend/;
                proxy_http_version 1.1;
        }

        location /test1 {
                proxy_pass http://192.168.64.53:9998;
        }

        location /test2 {
                proxy_pass http://192.168.64.53:9999;
        }
}
```

Restart dịch vụ nginx
```sh
systemctl restart nginx
```

Khi này request đến `http://192.168.64.53:8000/testlb` request sẽ được phân bổ lần lượt cho server test1 (60%) và server test2 (40%)













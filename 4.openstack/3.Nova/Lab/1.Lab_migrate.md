# Thực hành cold migrate
vm trên node: 10.2.1.201 (node1)
Migrate sang node 10.2.1.202 (node2)

### 1. Cấu hình ssh
Cho phép user nova có thể login (thực hiện trên tất cả các node compute).
```sh
usermod -s /bin/bash nova
```

Thực hiện tạo key pair trên node compute nguồn cho user nova
```sh
su nova
ssh-keygen
echo 'StrictHostKeyChecking no' >> /var/lib/nova/.ssh/config
exit
```

Thực hiện với quyền root, scp key pair tới compute node. Nhập mật khẩu khi được yêu cầu.
```sh
scp /var/lib/nova/.ssh/id_rsa.pub root@10.2.1.202:/root/
```

Trên node đích, thay đổi quyền của key pair cho user nova và add key pair đó vào SSH.
```sh
mkdir -p /var/lib/nova/.ssh
cat /root/id_rsa.pub >> /var/lib/nova/.ssh/authorized_keys
echo 'StrictHostKeyChecking no' >> /var/lib/nova/.ssh/config
chown -R nova:nova /var/lib/nova/.ssh
```

Từ node compute1 kiểm tra để chắc chắn rằng user nova có thể login được vào node compute2 còn lại mà không cần sử dụng password
```sh
su nova
# Cấu hình ssh sử dụng private key khi sử dụng user nova để ssh tới bất cứ host nào
cat <<EOF >> ~/.ssh/config
Host *
     User     nova
     IdentityFile       ~/.ssh/id_rsa
EOF
ssh 192.168.40.73
exit
```

### 2. Thực hiện migrate
Tắt máy ảo nếu nó đang chạy:
```sh
openstack server stop vm-migrate2
```

Thực hiện migrate:
```sh
openstack server migrate vm-migrate2
```

Kiểm tra trạng thái của máy ảo
```sh
openstack server show vm-migrate2
```

# Thực hành live migrate
## Block storage



















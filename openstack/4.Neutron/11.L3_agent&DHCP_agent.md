# 1. L3 Agent
- L3 Agent (Layer 3 Agent) là một thành phần quan trọng của dịch vụ Neutron, hoạt động như một router ảo (virtual router), chịu trách nhiệm định tuyến lưu lượng giữa các mạng khác nhau (Layer 2) và cung cấp dịch vụ cổng (gateway) để kết nối mạng ảo trong OpenStack với mạng vật lý bên ngoài, xử lý các tác vụ như NAT, định tuyến tĩnh, chuyển hướng IP

- Vai trò và chức năng chính:

    + Định tuyến Layer 3: L3 Agent thực hiện các chức năng định tuyến IP, cho phép các máy ảo (VM) giao tiếp với nhau trên các mạng con (subnet) khác nhau và kết nối ra mạng ngoài.

    + Dịch vụ Gateway: Nó cung cấp điểm ra/vào (gateway) cho mạng ảo, cho phép các VM có thể truy cập Internet hoặc các tài nguyên bên ngoài.

    + Network Address Translation (NAT): Thực hiện các kiểu NAT khác nhau (Source NAT, Destination NAT) để quản lý địa chỉ IP.

    + Giao tiếp: L3 Agent giao tiếp với neutron-server thông qua hàng đợi tin nhắn (messaging queue) để nhận lệnh và báo cáo trạng thái. 

### Source Nat & Destination Nat
![dnat&snat](img/snat-dnat.jpg)

# 2. DHCP agent
- DHCP Agent là một thành phần của Neutron (mạng OpenStack) có nhiệm vụ cấp phát địa chỉ IP tự động (cùng các thông tin mạng khác như subnet mask, gateway) cho các máy ảo (VMs) khi chúng được khởi tạo và kết nối vào một mạng ảo (tenant network).

- Agent này hoạt động như một máy chủ DHCP, sử dụng các công cụ như `dnsmasq` để quản lý việc cấp phát IP, đảm bảo các máy ảo có thể giao tiếp được trong mạng của chúng và với thế giới bên ngoài. 

- Vai trò chính:
    + Cấp IP tự động: Cung cấp địa chỉ IP, gateway, DNS cho VMs, giúp quản trị viên không cần cấu hình thủ công.

    + Tương thích với các tính năng mạng: Hỗ trợ nhiều chế độ cấp phát IP (IPv4, IPv6 stateful/stateless).

- Hoạt động trong hệ sinh thái OpenStack:
    + Neutron: DHCP Agent là một trong các agent (như L3 agent, metadata agent) mà Neutron (OpenStack Networking) quản lý để cung cấp dịch vụ mạng.

    + Plugin: Các plugin (như ML2) trong Neutron quản lý và điều phối các agent này để thực thi các chính sách mạng.

    + Mạng ảo: Khi một người dùng tạo một mạng ảo trong OpenStack (ví dụ, thông qua Horizon hoặc CLI), một hoặc nhiều DHCP Agent sẽ được chỉ định để xử lý yêu cầu IP cho mạng đó. 









